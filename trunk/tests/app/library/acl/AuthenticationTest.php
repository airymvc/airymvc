<?php


/**
 * Test class for Authentication.
 * Generated by PHPUnit on 2012-05-02 at 14:40:07.
 */
class AuthenticationTest extends PHPUnit_Framework_TestCase {

    /**
     * Sets up the fixture, for example, opens a network connection.
     * This method is called before a test is executed.
     */
    public function testSetUp() {
    }

    /**
     * Tears down the fixture, for example, closes a network connection.
     * This method is called after a test is executed.
     */
    protected function tearDown() {
        
    }


    /**
     * @covers Authentication::getLoginController
     * @todo Implement testGetLoginController().
     */
    public function testGetLoginController() {
    	$aclxml = dirname(dirname(dirname((dirname(__FILE__))))) . '/testfiles/test_aclxml.xml';
    	Authentication::setAclXml($aclxml);
    	$result = Authentication::getLoginController("test_module2");
    	$compare = "UserLogin";
    	$this->assertEquals($result, $compare);
    }


    /**
     * @covers Authentication::getLoginErrorAction
     * @todo Implement testGetLoginErrorAction().
     */
    public function testGetLoginErrorAction() {
    	$aclxml = dirname(dirname(dirname((dirname(__FILE__))))) . '/testfiles/test_aclxml.xml';
    	Authentication::setAclXml($aclxml);
    	$result = Authentication::getLoginErrorAction("test_module2");
    	$compare = "userLoginError";
    	$this->assertEquals($result, $compare);
    }


    /**
     * @covers Authentication::getLoginExcludeActions
     * @todo Implement testGetLoginExcludeActions().
     */
    public function testGetLoginExcludeActions() {
    	$aclxml = dirname(dirname(dirname((dirname(__FILE__))))) . '/testfiles/test_aclxml.xml';
    	Authentication::setAclXml($aclxml);
    	$result = Authentication::getLoginExcludeActions("test_module2");
    	$compare = array("UserLogin" => array("signIn" => "signIn",
    										  "userLogin" => "userLogin",
    										  "userLoginError" => "userLoginError"
    										 )
    					);
    	$this->assertEquals($result['UserLogin']['signIn'], $compare['UserLogin']['signIn']);
    	$this->assertEquals($result['UserLogin']['userLogin'], $compare['UserLogin']['userLogin']);
    	$this->assertEquals($result['UserLogin']['userLoginError'], $compare['UserLogin']['userLoginError']);
    }

    /**
     * @covers Authentication::getAllAllows
     * @todo Implement testGetAllAllows().
     */
    public function testGetAllAllows() {
    	$aclxml = dirname(dirname(dirname((dirname(__FILE__))))) . '/testfiles/test_aclxml.xml';
    	Authentication::setAclXml($aclxml);
    	$result = Authentication::getAllAllows("test_module2");

    	$compare = array("Demo" => "ALL_ACTIONS");
    	$this->assertEquals($result['Demo'], $compare['Demo']);
    }

    /**
     * @covers Authentication::getAllAllows
     * @todo Implement testGetAllAllows().
     */
    public function testGetOtherExclusiveActions() {
    	$aclxml = dirname(dirname(dirname((dirname(__FILE__))))) . '/testfiles/test_aclxml.xml';
    	Authentication::setAclXml($aclxml);
    	$result = Authentication::getOtherExclusiveActions("test_module2");

    	$compare = array("register", "add", "sendemail");
    	$this->assertEquals($result[0], $compare[0]);
    	$this->assertEquals($result[1], $compare[1]);
    	$this->assertEquals($result[2], $compare[2]);
    }
    
}

?>
